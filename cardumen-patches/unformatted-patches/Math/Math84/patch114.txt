--- /original/org/apache/commons/math/optimization/direct/MultiDirectional.java	
+++ /fixed/org/apache/commons/math/optimization/direct/MultiDirectional.java	
@@ -34,7 +34,7 @@
 				return ;
 			}
 			final org.apache.commons.math.optimization.RealPointValuePair contracted = evaluateNewSimplex(original, gamma, comparator);
-			if ((comparator.compare(contracted, best)) < 0) {
+			if (((gamma) < (khi)) || ((gamma) < ((khi) * (java.lang.Math.max(java.lang.Math.abs(gamma), java.lang.Math.abs(gamma)))))) {
 				return ;
 			}
 		}